# 要件書

## はじめに

JMAアメダスサイトの気象データテーブルに条件付き書式（カラースケール）機能を追加します。この機能により、各項目の数値の大小を視覚的に把握できるようになります。ユーザーはカラースケールのオン・オフを切り替えることができ、各項目のカラースケールを個別にカスタマイズすることも可能です。

## 要件

### 要件1

**ユーザーストーリー:** 気象データ利用者として、数値データの大小を視覚的に把握したいので、テーブルの各セルに値に応じたカラースケールが適用されることを望む

#### 受入基準

1. WHEN ユーザーがJMAアメダスのエリアテーブルページを開いた時 THEN システムは数値データを含む各列にカラースケールを適用する SHALL
2. WHEN ユーザーがJMAアメダスの時系列テーブルページを開いた時 THEN システムは数値データを含む各列にカラースケールを適用する SHALL
3. WHEN セルに数値データが存在する時 THEN システムは事前に設定しておいた最小値から最大値の範囲でカラースケールを計算し背景色を適用する SHALL
4. WHEN セルにデータが欠損している時（「---」表示）THEN システムはカラースケールを適用しない SHALL

### 要件2

**ユーザーストーリー:** 気象データ利用者として、カラースケールの表示を制御したいので、機能のオン・オフを切り替えられることを望む

#### 受入基準

1. WHEN ページが読み込まれた時 THEN システムはカラースケール機能を制御するチェックボックスを表示する SHALL
2. WHEN ユーザーがチェックボックスをオンにした時 THEN システムは全ての対象列にカラースケールを適用する SHALL
3. WHEN ユーザーがチェックボックスをオフにした時 THEN システムは全ての列からカラースケールを削除する SHALL
4. WHEN ページがリロードされた時 THEN システムは前回の設定状態を復元する SHALL

### 要件3

**ユーザーストーリー:** 気象データ利用者として、各項目に適したカラースケールを使用したいので、項目ごとにカラースケールをカスタマイズできることを望む

#### 受入基準

1. WHEN ページが読み込まれた時 THEN システムは各対象列のカラースケール設定UIを表示する SHALL
2. WHEN ユーザーがカラースケール設定を変更した時 THEN システムは該当列のカラースケールを即座に更新する SHALL
3. WHEN システムがカラースケールを適用する時 THEN 気温は青から赤のグラデーション、湿度は白から青のグラデーションをデフォルトとして使用する SHALL
4. WHEN ユーザーがカラースケール設定を変更した時 THEN システムは設定をローカルストレージに保存する SHALL

### 要件4

**ユーザーストーリー:** 既存機能の利用者として、カラースケール機能追加後も他の機能が正常に動作することを望む

#### 受入基準

1. WHEN カラースケール機能が追加された時 THEN 既存の体積絶対湿度、露点温度、不快指数の計算機能は正常に動作し続ける SHALL
2. WHEN テーブルが更新された時 THEN カラースケールも適切に再計算・再適用される SHALL
3. WHEN カラースケールが適用された時 THEN テーブルの文字の可読性が保たれる SHALL
4. WHEN カラースケール機能が無効化された時 THEN テーブルは元の外観に戻る SHALL

### 要件5

**ユーザーストーリー:** 気象データ利用者として、カラースケール機能を直感的に使用したいので、分かりやすいUIが提供されることを望む

#### 受入基準

1. WHEN カラースケール設定UIが表示される時 THEN 各項目名と対応するカラースケール設定が明確に識別できる SHALL
2. WHEN ユーザーがカラースケール設定を操作する時 THEN 変更がリアルタイムでプレビューされる SHALL
3. WHEN カラースケール設定UIが表示される時 THEN テーブルの下部に配置される SHALL
4. WHEN カラースケール機能がオフの時 THEN カラースケール設定UIは非表示または無効化される SHALL
