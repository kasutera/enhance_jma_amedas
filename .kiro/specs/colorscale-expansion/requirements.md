# 要件定義書

## 概要

現在のカラースケール機能は、計算された気象パラメータ（容積絶対湿度、露点温度、不快指数）のみに適用されています。この機能を拡張して、JMA公式の基本気象データ（1時間降水量、湿度、気温、風速）にも気象庁公式カラースケールを適用し、データの視覚的な理解を向上させます。

## 要件

### 要件1：気温データのカラースケール対応

**ユーザーストーリー:** 気象データ分析者として、JMAアメダステーブルの気温値に色分けを適用して、温度パターンや極値を素早く識別したい。

#### 受入基準

1. テーブルに気温データ（td-tempクラス）が含まれる場合、システムは気象庁公式の気温カラースケールを適用すること
2. 気温値が-5°C未満の場合、システムは濃い青色の背景で表示すること
3. 気温値が35°C超の場合、システムは紫色の背景で表示すること
4. 気温セルに色付き背景がある場合、システムは最適な可読性のために文字色を調整すること

### 要件2：湿度データのカラースケール対応

**ユーザーストーリー:** 気象学者として、JMAアメダステーブルの湿度値に色分けを適用して、異なる地点の湿度状況を素早く評価したい。

#### 受入基準

1. テーブルに湿度データ（td-humidityクラス）が含まれる場合、システムは気象庁公式の湿度カラースケールを適用すること
2. 湿度値が20%未満の場合、システムは茶色/オレンジ系の色調で表示すること
3. 湿度値が80%超の場合、システムは青系の色調で表示すること
4. 湿度セルに色付き背景がある場合、システムは最適な可読性のために文字色を調整すること

### 要件3：降水量データのカラースケール対応

**ユーザーストーリー:** 気象観測者として、JMAアメダステーブルの降水量値に色分けを適用して、大雨の地域を素早く識別したい。

#### 受入基準

1. テーブルに1時間降水量データ（td-precipitation1hクラス）が含まれる場合、システムは気象庁公式の降水量カラースケールを適用すること
2. 降水量値が80mm超の場合、システムは紫色の背景で表示すること
3. 降水量値が1-5mmの場合、システムは薄い紫/青系の色調で表示すること
4. 降水量セルに色付き背景がある場合、システムは最適な可読性のために文字色を調整すること

### 要件4：風速データのカラースケール対応

**ユーザーストーリー:** 風況監視専門家として、JMAアメダステーブルの風速値に色分けを適用して、強風地域を素早く識別したい。

#### 受入基準

1. テーブルに風速データ（td-windクラス）が含まれる場合、システムは気象庁公式の風速カラースケールを適用すること
2. 風速値が25m/s超の場合、システムは紫色の背景で表示すること
3. 風速値が5m/s未満の場合、システムは白色の背景で表示すること
4. 風速セルに色付き背景がある場合、システムは最適な可読性のために文字色を調整すること

### 要件5：統一的なカラースケール制御

**ユーザーストーリー:** カラースケール機能のユーザーとして、新しいカラースケールも同じ有効/無効トグルで制御して、すべてのカラースケールを一貫して管理したい。

#### 受入基準

1. カラースケール機能が有効な場合、システムは既存の計算パラメータと基本気象データの両方にカラースケールを適用すること
2. カラースケール機能が無効な場合、システムは新しい列を含むすべての列からカラースケールを削除すること
3. ユーザーがカラースケール設定を切り替える場合、システムは設定をlocalStorageに保存すること
4. ページが読み込まれる場合、システムはlocalStorageからカラースケール設定を復元すること

### 要件6：気象庁公式基準の遵守

**ユーザーストーリー:** カラースケールシステムを保守する開発者として、カラースケール定義が気象庁公式基準に従って、公式ガイドラインに従って気象データを正確に表現したい。

#### 受入基準

1. カラースケールを定義する場合、システムは気象庁公式文書の正確な色値を使用すること
2. カラースケールが適用される場合、システムは既存のJMA視覚基準との一貫性を保つこと
3. 新しいカラースケールが追加される場合、システムは既存のカラースケール定義と同じ構造に従うこと
4. 色の補間が必要な場合、システムは既存のColorScaleCalculatorメソッドを使用すること
